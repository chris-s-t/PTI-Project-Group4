<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2D Sailing Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { overflow: hidden; margin: 0; background-color: #87CEEB; }
        #gameCanvas { background: url('water.png') repeat; display: block; }
        #hud { position: absolute; top: 10px; left: 10px; font-size: 20px; width: 200px; background-image: 'Fighter1.jpg';}
        .bar-container { width: 100%; background-color: rgba(255, 255, 255, 0.5); border-radius: 5px; overflow: hidden; margin-bottom: 5px; }
        .bar { height: 20px; transition: width 0.2s ease-in-out; }
        #fuelBar { background-color: yellow; width: 100%; }
        #healthBar { background-color: red; width: 100%; }
        #hygieneBar { background-color: green; width: 100%; }
        #warning { position: absolute; top: 70px; left: 10px; font-size: 20px; color: red; display: none; }
        #gameOverScreen {
            display: none;
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <div id="hud">
        <div class="bar-container"><div id="fuelBar" class="bar"></div></div>
        <div class="bar-container"><div id="healthBar" class="bar"></div></div>
        <div class="bar-container"><div id="hygieneBar" class="bar"></div></div>
    </div>
    <div id="warning">⚠️ Low Fuel! ⚠️</div>
    <div id="gameOverScreen">
        <h1>Game Over</h1>
        <button onclick="restartGame()" class="bg-white text-black p-2 rounded">Restart</button>
    </div>
    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let boat, obstacles, fuelPickups;
        let keysPressed = { w: false, a: false, s: false, d: false };
        let rotation = 0;  // Boat's current rotation in degrees

        function initializeGame() {
            boat = {
                x: canvas.width / 2,
                y: canvas.height / 2,
                width: 50,
                height: 50,
                speed: 3,
                dx: 0,
                dy: 0,
                fuel: 100,
                health: 100,
                hygiene: 100
            };
            obstacles = [];
            fuelPickups = [];
            keysPressed = { 
                w: false, 
                a: false, 
                s: false, 
                d: false 
            };
            document.getElementById("gameOverScreen").style.display = "none";
        }

        function generateObjects() {
            if (Math.random() < 0.02) {
                obstacles.push({
                    x: boat.x + Math.random() * canvas.width - canvas.width / 2,
                    y: boat.y + Math.random() * canvas.height - canvas.height / 2,
                    size: 30 + Math.random() * 20
                });
            }
            if (Math.random() < 0.01) {
                fuelPickups.push({
                    x: boat.x + Math.random() * canvas.width - canvas.width / 2,
                    y: boat.y + Math.random() * canvas.height - canvas.height / 2,
                    size: 20
                });
            }
        }

        function drawObjects() {
            ctx.fillStyle = "brown";
            obstacles.forEach(obstacle => {
                ctx.fillRect(obstacle.x - boat.x + canvas.width / 2, obstacle.y - boat.y + canvas.height / 2, obstacle.size, obstacle.size);
            });

            ctx.fillStyle = "yellow";
            fuelPickups.forEach(fuel => {
                ctx.beginPath();
                ctx.arc(fuel.x - boat.x + canvas.width / 2, fuel.y - boat.y + canvas.height / 2, fuel.size / 2, 0, Math.PI * 2);
                ctx.fill();
            });
        }

        function drawBoat() {
            let hygieneFactor = boat.hygiene / 100;
            let colorIntensity = Math.floor(255 * hygieneFactor);
            ctx.save(); // Save the current state
            ctx.translate(canvas.width / 2, canvas.height / 2); // Move to the center
            ctx.rotate(rotation * Math.PI / 180); // Rotate by the current rotation angle
            ctx.fillStyle = `rgb(${colorIntensity}, ${colorIntensity}, ${colorIntensity})`;
            ctx.fillRect(-boat.width / 2, -boat.height / 2, boat.width, boat.height); // Draw the boat centered at (0, 0)
            ctx.restore(); 
        }

        function updateBars() {
            document.getElementById("fuelBar").style.width = boat.fuel + "%";
            document.getElementById("healthBar").style.width = boat.health + "%";
            document.getElementById("hygieneBar").style.width = boat.hygiene + "%";
        }

        function updatePosition() {
            if (boat.fuel > 0) {
                boat.x += boat.dx;
                boat.y += boat.dy;
                boat.fuel -= (Math.abs(boat.dx) + Math.abs(boat.dy)) * 0.05;
                boat.hygiene = Math.max(0, boat.hygiene - 0.02);
                boat.fuel = Math.max(0, boat.fuel);
                boat.health = Math.max(0, boat.health);
                updateBars();
                if (boat.fuel < 20) document.getElementById("warning").style.display = "block";
                else document.getElementById("warning").style.display = "none";
            } else {
                document.getElementById("gameOverScreen").style.display = "flex";
            }
        }

        function gameLoop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            generateObjects();
            drawObjects();
            drawBoat();
            updatePosition();
            requestAnimationFrame(gameLoop);
        }

        function restartGame() {
            initializeGame();
            gameLoop();
        }

        function getShortestRotation(current, target) {
            const difference = target - current;
            if (difference > 180) return difference - 360; 
            if (difference < -180) return difference + 360; 
            return difference;
        }
        function updateBoatMovement() {
            let rad = (rotation - 90) * Math.PI / 180;
            boat.dx = Math.cos(rad) * boat.speed;
            boat.dy = Math.sin(rad) * boat.speed;
        }
        document.addEventListener("keydown", (event) => {
            if (event.key === "w") keysPressed.w = true;
            if (event.key === "a") keysPressed.a = true;
            if (event.key === "s") keysPressed.s = true;
            if (event.key === "d") keysPressed.d = true;
            if (keysPressed.w && keysPressed.a) {
                rotateToTarget(315); 
            } else if (keysPressed.a && keysPressed.s) {
                rotateToTarget(225); 
            } else if (keysPressed.s && keysPressed.d) {
                rotateToTarget(135); 
            } else if (keysPressed.d && keysPressed.w) {
                rotateToTarget(45); 
            } else {
                
                if (keysPressed.w) rotateToTarget(0);   
                if (keysPressed.s) rotateToTarget(180); 
                if (keysPressed.a) rotateToTarget(270); 
                if (keysPressed.d) rotateToTarget(90);  
            }

            updateBoatMovement(); 
        });

        document.addEventListener("keyup", (event) => {
            if (event.key === "w") keysPressed.w = false;
            if (event.key === "a") keysPressed.a = false;
            if (event.key === "s") keysPressed.s = false;
            if (event.key === "d") keysPressed.d = false;
            if (!keysPressed.w && !keysPressed.a && !keysPressed.s && !keysPressed.d) {
                boat.dx = 0;
                boat.dy = 0;
            }
        });

        function rotateToTarget(targetRotation) {
            const shortestRotation = getShortestRotation(rotation, targetRotation);
            rotation += shortestRotation;
        }

        initializeGame();
        gameLoop();
    </script>
</body>
</html>
